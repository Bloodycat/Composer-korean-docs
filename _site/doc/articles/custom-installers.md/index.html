<!DOCTYPE html>
<html>
<head>
    <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

    <title>Setting up and using custom installers</title>
    <meta name="description" content="컴포저 한글 메뉴얼에 대한 메뉴얼 페이지입니다." />

    <script src="/Composer-korean-docs/js/prism.js"></script>

    <link rel="stylesheet" href="/Composer-korean-docs/css/layout.css" />
    <link rel="canonical" href="http://www.xpressengine.com/Composer-korean-docs/doc/articles/custom-installers.md/" >
</head>

</head>

<body>

    <header>
    <div class="wrap">
        <div class="logo">
            <a href="/Composer-korean-docs/"><img src="/Composer-korean-docs/images/logo-composer-transparent.png" /></a>
            <h1><a href="/Composer-korean-docs/">Composer korean docs<small>Composer 의 한글 매뉴얼입니다.</small></a></h1>
        </div>
        <div class="btn_area">
            <a class="button" href="https://github.com/xpressengine/Composer-korean-docs/tree/master/KR">View on Github</a>
            <a class="button" href="https://github.com/xpressengine/Composer-korean-docs.git">Git Repository</a>
        </div>
    </div>
</header>
<div class="body docs">
    <div class="wrap clearfix">
        <aside class="sidebar">
            <div class="title">메뉴얼</div>
<ul>
    <li>00 - <a href="/Composer-korean-docs/doc/00-intro.md">소개하기</a></li>
    <li>01 - <a href="/Composer-korean-docs/doc/01-basic-usage.md">기본 사용법</a></li>
    <li>02 - <a href="/Composer-korean-docs/doc/02-libraries.md">라이브러리</a></li>
    <li>03 - <a href="/Composer-korean-docs/doc/03-cli.md">커맨드라인 인터페이스 / 명령어</a></li>
    <li>04 - <a href="/Composer-korean-docs/doc/04-schema.md">composer.json의 구조</a></li>
    <li>05 - <a href="/Composer-korean-docs/doc/05-repositories.md">Repositories - 저장소</a></li>
    <li>06 - <a href="/Composer-korean-docs/doc/05-repositories.md">커뮤니티</a></li>
</ul>

<div class="title">기타항목</div>
<ul>
    <li><p><a href="/Composer-korean-docs/doc/articles/aliases.md">Aliases-별칭</a>
        : 버전과 브랜치 네임의 별칭을 구성하는 법 </p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/custom-installers.md">커스텀 인스톨러</a>
        : 패키지의 특정한 유형의 설치 방법을 수정하기</p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/handling-private-packages-with-satis.md">Satis 또는 Toran 프록시를 통해서 전용 패키지를 구성하는법</a>
        : 고유한 자신의 컴포저 저장소를 운영하는 방법</p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/http-basic-authentication.md">HTTP 기본 인증 사용법</a>
        : private 호스트에 위치한 패키지에 엑세스 하는 방법</p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/plugins.md">플러그인을 설정하고 사용하는 방법</a>
        : 컴포저의 기능을 확장하고 수정하는 방법</p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/scripts.md">스크립트</a>
        : 패키지를 설치한 전후에 호출되는 스크립트 콜백</p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/troubleshooting.md">트러블 슈팅</a>
        : 문제점 해결</p></li>
    <li><p><a href="/Composer-korean-docs/doc/articles/vendor-binaries.md">벤더 바이너리와 <code>vendor/bin</code> 디렉토리</a>
        : 패키지의 커맨드라인 스크립트를 확인하는 방법 </p></li>
</ul>

<div class="title">supported by</div>
<ul>
    <li><a href="http://www.xpressengine.com/" target="_blank"><img src="/Composer-korean-docs/images/XE_symbol_512.png" width="144" border="0" /></a></li>
    <li><a href="http://dev.naver.com/d2" target="_blank"><img src="/Composer-korean-docs/images/NAVER_D2_c_hor.png" width="144"/></a></li>
</ul>

<div class="title">Other Project</div>
<ul>
    <li><a href="http://xpressengine.github.io/XEIcon/" target="_blank"><img src="/Composer-korean-docs/images/xeicon_banner.png" width="144"/></a></li>
    <li><a href="http://xpressengine.github.io/laravel-korean-docs/" target="_blank"><img src="/Composer-korean-docs/images/laravel-banner.png" width="144"/></a></li>
    <li>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</li>
</ul>

        </aside>


    <article class="content">
        <h1 id="setting-up-and-using-custom-installers">Setting up and using custom installers</h1>

<h2 id="synopsis">Synopsis</h2>

<p>At times it may be necessary for a package to require additional actions during
installation, such as installing packages outside of the default <code>vendor</code>
library.</p>

<p>In these cases you could consider creating a Custom Installer to handle your
specific logic.</p>

<h2 id="calling-a-custom-installer">Calling a Custom Installer</h2>

<p>Suppose that your project already has a Custom Installer for specific modules
then invoking that installer is a matter of defining the correct <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> in
your package file.</p>

<blockquote>
  <p><em>See the next chapter for an instruction how to create Custom Installers.</em></p>
</blockquote>

<p>Every Custom Installer defines which <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> string it will recognize. Once
recognized it will completely override the default installer and only apply its
own logic.</p>

<p>An example use-case would be:</p>

<blockquote>
  <p>phpDocumentor features Templates that need to be installed outside of the
default /vendor folder structure. As such they have chosen to adopt the
<code>phpdocumentor-template</code> <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> and create a plugin providing the Custom
Installer to send these templates to the correct folder.</p>
</blockquote>

<p>An example composer.json of such a template package would be:</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;phpdocumentor/template-responsive&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;phpdocumentor-template&quot;</span><span class="p">,</span>
    <span class="nt">&quot;require&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;phpdocumentor/template-installer-plugin&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<blockquote>
  <p><strong>IMPORTANT</strong>: to make sure that the template installer is present at the
time the template package is installed, template packages should require
the plugin package.</p>
</blockquote>

<h2 id="creating-an-installer">Creating an Installer</h2>

<p>A Custom Installer is defined as a class that implements the
<a href="https://github.com/composer/composer/blob/master/src/Composer/Plugin/PluginInterface.php"><code>Composer\Installer\InstallerInterface</code></a> and is usually distributed in a
Composer Plugin.</p>

<p>A basic Installer Plugin would thus compose of three files:</p>

<ol>
  <li>the package file: composer.json</li>
  <li>The Plugin class, e.g.: <code>My\Project\Composer\Plugin.php</code>, containing a class that implements <code>Composer\Plugin\PluginInterface</code>.</li>
  <li>The Installer class, e.g.: <code>My\Project\Composer\Installer.php</code>, containing a class that implements <code>Composer\Installer\InstallerInterface</code>.</li>
</ol>

<h3 id="composerjson">composer.json</h3>

<p>The package file is the same as any other package file but with the following
requirements:</p>

<ol>
  <li>the <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> attribute must be <code>composer-plugin</code>.</li>
  <li>the <a href="/Composer-korean-docs/doc/04-schema.md#extra">extra</a> attribute must contain an element <code>class</code> defining the
class name of the plugin (including namespace). If a package contains
multiple plugins this can be array of class names.</li>
</ol>

<p>Example:</p>

<div class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;phpdocumentor/template-installer-plugin&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;composer-plugin&quot;</span><span class="p">,</span>
    <span class="nt">&quot;license&quot;</span><span class="p">:</span> <span class="s2">&quot;MIT&quot;</span><span class="p">,</span>
    <span class="nt">&quot;autoload&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;psr-0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;phpDocumentor\\Composer&quot;</span><span class="p">:</span> <span class="s2">&quot;src/&quot;</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;extra&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;phpDocumentor\\Composer\\TemplateInstallerPlugin&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;require&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;composer-plugin-api&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<h3 id="the-plugin-class">The Plugin class</h3>

<p>The class defining the Composer plugin must implement the
<a href="https://github.com/composer/composer/blob/master/src/Composer/Plugin/PluginInterface.php"><code>Composer\Plugin\PluginInterface</code></a>. It can then register the Custom
Installer in its <code>activate()</code> method.</p>

<p>The class may be placed in any location and have any name, as long as it is
autoloadable and matches the <code>extra.class</code> element in the package definition.</p>

<p>Example:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">phpDocumentor\Composer</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Composer\Composer</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Composer\IO\IOInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Composer\Plugin\PluginInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TemplateInstallerPlugin</span> <span class="k">implements</span> <span class="nx">PluginInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">activate</span><span class="p">(</span><span class="nx">Composer</span> <span class="nv">$composer</span><span class="p">,</span> <span class="nx">IOInterface</span> <span class="nv">$io</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$installer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TemplateInstaller</span><span class="p">(</span><span class="nv">$io</span><span class="p">,</span> <span class="nv">$composer</span><span class="p">);</span>
        <span class="nv">$composer</span><span class="o">-&gt;</span><span class="na">getInstallationManager</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addInstaller</span><span class="p">(</span><span class="nv">$installer</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<h3 id="the-custom-installer-class">The Custom Installer class</h3>

<p>The class that executes the custom installation should implement the
<a href="https://github.com/composer/composer/blob/master/src/Composer/Installer/InstallerInterface.php"><code>Composer\Installer\InstallerInterface</code></a> (or extend another installer that
implements that interface). It defines the <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> string as it will be
recognized by packages that will use this installer in the <code>supports()</code> method.</p>

<blockquote>
  <p><strong>NOTE</strong>: <em>choose your <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> name carefully, it is recommended to follow
the format: <code>vendor-type</code></em>. For example: <code>phpdocumentor-template</code>.</p>
</blockquote>

<p>The InstallerInterface class defines the following methods (please see the
source for the exact signature):</p>

<ul>
  <li><strong>supports()</strong>, here you test whether the passed <a href="/Composer-korean-docs/doc/04-schema.md#type">type</a> matches the name
that you declared for this installer (see the example).</li>
  <li><strong>isInstalled()</strong>, determines whether a supported package is installed or not.</li>
  <li><strong>install()</strong>, here you can determine the actions that need to be executed
upon installation.</li>
  <li><strong>update()</strong>, here you define the behavior that is required when Composer is
invoked with the update argument.</li>
  <li><strong>uninstall()</strong>, here you can determine the actions that need to be executed
when the package needs to be removed.</li>
  <li><strong>getInstallPath()</strong>, this method should return the location where the
package is to be installed, <em>relative from the location of composer.json.</em></li>
</ul>

<p>Example:</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">phpDocumentor\Composer</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Composer\Package\PackageInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Composer\Installer\LibraryInstaller</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TemplateInstaller</span> <span class="k">extends</span> <span class="nx">LibraryInstaller</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * {@inheritDoc}</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPackageBasePath</span><span class="p">(</span><span class="nx">PackageInterface</span> <span class="nv">$package</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$prefix</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getPrettyName</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;phpdocumentor/template-&#39;</span> <span class="o">!==</span> <span class="nv">$prefix</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">\InvalidArgumentException</span><span class="p">(</span>
                <span class="s1">&#39;Unable to install template, phpdocumentor templates &#39;</span>
                <span class="o">.</span><span class="s1">&#39;should always start their package name with &#39;</span>
                <span class="o">.</span><span class="s1">&#39;&quot;phpdocumentor/template-&quot;&#39;</span>
            <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="s1">&#39;data/templates/&#39;</span><span class="o">.</span><span class="nb">substr</span><span class="p">(</span><span class="nv">$package</span><span class="o">-&gt;</span><span class="na">getPrettyName</span><span class="p">(),</span> <span class="mi">23</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * {@inheritDoc}</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">supports</span><span class="p">(</span><span class="nv">$packageType</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;phpdocumentor-template&#39;</span> <span class="o">===</span> <span class="nv">$packageType</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>The example demonstrates that it is quite simple to extend the
<a href="https://github.com/composer/composer/blob/master/src/Composer/Installer/LibraryInstaller.php"><code>Composer\Installer\LibraryInstaller</code></a> class to strip a prefix
(<code>phpdocumentor/template-</code>) and use the remaining part to assemble a completely
different installation path.</p>

<blockquote>
  <p><em>Instead of being installed in <code>/vendor</code> any package installed using this
Installer will be put in the <code>/data/templates/&lt;stripped name&gt;</code> folder.</em></p>
</blockquote>


    </article>

        </div>
</div>

<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-46389165-6");
        pageTracker._trackPageview();
    } catch(err) {}
</script>


</body>
</html>
